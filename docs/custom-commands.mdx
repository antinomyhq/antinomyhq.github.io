---
title: Custom Commands
slug: /custom-commands
sidebar_position: 3
description: "Create and configure your own custom commands in Forge to streamline workflows"
sidebar_label: Custom Commands
---

# Custom Commands

Forge allows you to define and use custom commands that extend its functionality and streamline your workflow. These commands can be executed within the Forge CLI using the `/command_name` syntax and are defined as individual files in the `~/forge/commands/` directory.

## What Are Custom Commands?

Custom commands are user-defined shortcuts that trigger specific actions or workflows. They enable you to:

- Create project-specific automation
- Standardize common workflows across your team
- Simplify complex operations into single commands
- Integrate Forge with your development processes

## Defining Custom Commands

Custom commands are defined as individual Markdown files in the `~/forge/commands/` directory. Each command file follows the naming convention `command-name.md`.

### Command File Structure

Create a Markdown file in `~/forge/commands/` with frontmatter containing metadata and the body containing the prompt:

**`~/forge/commands/commit.md`**

```markdown
---
name: commit
description: Commit changes with a standard prefix
---

Understand the diff produced and commit using the 'conventional commit' standard
```

**`~/forge/commands/branch.md`**

```markdown
---
name: branch
description: Create and checkout a new branch
---

Create a new branch based on the current changes and checkout to it
```

**`~/forge/commands/check.md`**

```markdown
---
name: check
description: Checks if the code is ready to be committed
---

- Run the `lint` and `test` commands and verify if everything is fine.
  <lint>npm run lint</lint>
  <test>npm test</test>
- Fix every issue found in the process
```

### File Format

Command files use Markdown with YAML frontmatter:

- **Frontmatter**: Contains `name` and `description` fields enclosed in `---`
- **Body**: The content after frontmatter becomes the default prompt for the command
- **Templates**: Support Handlebars template syntax using `{{parameters}}` placeholders for dynamic prompts

### Configuration Options

| Option        | Required | Location    | Description                                              |
| ------------- | -------- | ----------- | -------------------------------------------------------- |
| `name`        | Yes      | Frontmatter | The name of the command (used as `/name` in the CLI)     |
| `description` | Yes      | Frontmatter | A description of what the command does (shown in help)   |
| prompt        | No       | Body        | Default prompt value used when no arguments are provided |

:::warning Deprecated: Commands in forge.yaml
Defining commands in the `commands` section of `forge.yaml` is **deprecated** and no longer supported. Please migrate your commands to individual Markdown files in the `~/forge/commands/` directory.
:::

## Using Custom Commands

Once configured, you can use custom commands in the Forge CLI in two ways:

### Basic Command Execution

To execute a command with its default value (if provided):

```bash
/commit
```

This executes the `commit` command with the default instructions defined in its `value` field.

### Command with Arguments

To override the default value or provide instructions for commands without a default:

```bash
/commit Create a detailed commit message for the login feature
```

```bash
/branch feature/new-auth
```

## How Custom Commands Work

When a custom command is executed, it follows this event flow:

1. **Command Execution**: User types a command like `/commit feat: add user authentication`
2. **Event Dispatch**: Forge dispatches an event with:
   - **Name**: The command name (e.g., `commit`)
   - **Value**: The provided argument or default value (e.g., `feat: add user authentication`)
3. **Agent Subscription**: Any agent that has subscribed to this event name receives the event
4. **Event Processing**: The agent processes the event according to its configuration

## Agent Configuration for Custom Commands

For an agent to respond to a custom command, it must explicitly subscribe to the event with the same name as the command:

```yaml
agents:
  - id: git-commit
    model: anthropic/claude-3.7-sonnet
    system_prompt: "{{> system-prompt-git-commit.hbs }}"
    tools:
      - forge_tool_process_shell
    subscribe:
      - commit # This agent subscribes to the 'commit' custom command
```

## Command Handling Approaches

There are two main approaches for handling custom command events in agents:

### 1. Using Event Value as Instructions

Pass the event value directly to the agent as complete instructions:

**`~/forge/commands/commit.md`**

```markdown
---
name: commit
description: Commit changes with a standard prefix
---

Understand the diff and commit using the 'conventional commit' standard
```

### 2. Using Event Value as Data in a Template

Incorporate the event value into a structured template:

**`~/forge/commands/analyze.md`**

```markdown
---
name: analyze
description: Analyze a file with specific focus
---

Perform a detailed analysis of the specified file
```

## Using Templates in Commands

Custom commands support Handlebars template syntax, allowing you to create dynamic prompts with parameters. Parameters can be accessed using the `{{parameters}}` syntax.

### Passing Parameters

Forge supports two parameter formats:

**1. JSON Object Format** (for structured data with multiple named parameters):

```bash
/command_name {"key1": "value1", "key2": "value2"}
```

**2. Direct Value Format** (for simple, single-value parameters):

```bash
/command_name simple value here
```

### Template Example 1: Structured Parameters

**`~/forge/commands/execute_operation.md`**

```markdown
---
name: execute_operation
description: Execute mathematical operations on lists
---

Perform the operation "{{parameters.operation}}" on the following input and output only the result.

Operation: {{parameters.operation}}
Input: {{parameters.input}}

Example: sum([1,2,3,4]) should output 10
```

**Usage with JSON format:**

```bash
/execute_operation {"operation": "sum", "input": [1,2,3]}
```

The template variables:

- `{{parameters.operation}}` - The operation to perform (e.g., "sum", "average", "max")
- `{{parameters.input}}` - The input data provided by the user

### Template Example 2: File Operations

**`~/forge/commands/refactor.md`**

```markdown
---
name: refactor
description: Refactor code with specific pattern
---

Refactor the file {{parameters.filepath}} by applying the {{parameters.pattern}} pattern.

Guidelines:

- Preserve existing functionality
- Add appropriate tests
- Update related documentation

Target file: {{parameters.filepath}}
Refactoring pattern: {{parameters.pattern}}
```

**Usage:**

```bash
/refactor {"filepath": "src/auth.ts", "pattern": "strategy"}
```

This demonstrates how templates work for file operations, not just math.

### Template Example 3: Simple Parameters

**`~/forge/commands/explain.md`**

```markdown
---
name: explain
description: Explain a concept in simple terms
---

Explain the following concept in simple terms with practical examples:

Topic: {{parameters}}

Provide:

1. A clear definition
2. Real-world analogies
3. Common use cases
4. Practical code examples
```

**Usage with direct value:**

```bash
/explain closures in JavaScript
```

When using direct values, `{{parameters}}` receives the entire argument string as-is.

### Advanced: Using Handlebars Conditionals

Handlebars templates support conditional logic using `{{#if}}` blocks. This is useful for handling optional parameters:

```markdown
---
name: analyze
description: Analyze code or files
---

{{#if parameters.file}}
Analyze the file: {{parameters.file}}
{{else}}
Analyze the current working directory
{{/if}}
```

**Usage:**

```bash
/analyze {"file": "src/main.ts"} # Analyzes specific file
/analyze                         # Analyzes current directory
```

For more advanced Handlebars features (loops, helpers, etc.), see the [Handlebars documentation](https://handlebarsjs.com/guide/).

### Template Benefits

- **Dynamic prompts**: Create commands that adapt based on input parameters
- **Reusable logic**: Define command templates once and use with different values
- **Structured data**: Pass complex data structures (arrays, objects) using JSON format
- **Flexible workflows**: Combine parameters in various ways to create sophisticated behaviors
- **Type flexibility**: Use simple strings or complex objects depending on your needs

### Troubleshooting Templates

**Malformed JSON** - Invalid JSON gets treated as a string. Use quotes around keys and values:

```bash
/refactor {filepath: "src/auth.ts"}   # Wrong - treated as string
/refactor {"filepath": "src/auth.ts"} # Correct JSON
```

**Missing Parameters** - Unset parameters render as empty strings. Use conditionals:

```markdown
{{#if parameters.filepath}}
File: {{parameters.filepath}}
{{else}}
Error: Please provide a filepath parameter
{{/if}}
```

**Format Mismatch** - Match your template to input format:

- JSON input: Use `{{parameters.property}}`
- Direct value: Use `{{parameters}}`

**Debug with `/dump`** - Shows exactly what's being sent after template rendering. Compare output with your expected result to find mismatches.

## Example Custom Commands

### Git Workflow Commands

**`~/forge/commands/commit.md`**

```markdown
---
name: commit
description: Commit changes with a standard prefix
---

Analyze changes and create a commit message following conventional commit format
```

````

**`~/forge/commands/branch.md`**

```markdown
---
name: branch
description: Create and checkout a new branch from the current changes
---

Create a new branch based on the context and checkout to it
```

**`~/forge/commands/pr.md`**

```markdown
---
name: pr
description: Create a pull request for current branch
---

Create a detailed pull request description based on the changes in this branch
```

### Development Workflow Commands

**`~/forge/commands/review.md`**

```markdown
---
name: review
description: Review code for bugs and improvements
---

Review the code for bugs, security issues, performance problems, and suggest improvements
```

**`~/forge/commands/document.md`**

```markdown
---
name: document
description: Generate documentation for a file
---

Generate comprehensive documentation for the specified code
```

**`~/forge/commands/test.md`**

```markdown
---
name: test
description: Generate unit tests for a file or function
---

Create comprehensive unit tests with good coverage for the specified code
```

### Project-Specific Commands

**`~/forge/commands/fixme.md`**

```markdown
---
name: fixme
description: Looks for all the fixme comments in the code and attempts to fix them
---

Find all the FIXME comments in source-code files and attempt to fix them.
```

**`~/forge/commands/deploy.md`**

```markdown
---
name: deploy
description: Prepare deployment package and update version numbers
---

Update version numbers and prepare the project for deployment
```

## Best Practices

1. **Descriptive Names**: Use clear, action-oriented names for commands (use lowercase with hyphens for multi-word commands)
2. **Helpful Descriptions**: Write descriptions that explain both the purpose and expected outcome
3. **Default Prompts**: Provide default prompts for commands that can work without specific arguments
4. **Specialized Agents**: Configure agents specifically for handling particular commands in `~/forge/agents/`
5. **File Organization**: Keep command files organized in `~/forge/commands/` with descriptive filenames
6. **Documentation**: Document custom commands for your team in a project README

## Migrating from forge.yaml

If you have commands defined in your `forge.yaml` file, migrate them to individual Markdown files:

**Old format (deprecated):**

```yaml
# forge.yaml
commands:
  - name: commit
    description: Commit changes
    prompt: |
      Create a commit message
```

**New format:**

```markdown
# ~/forge/commands/commit.md

---

name: commit
description: Commit changes

---

Create a commit message
```

### Migration Steps

1. Create the `~/forge/commands/` directory if it doesn't exist:

   ```bash
   mkdir -p ~/forge/commands
   ```

2. For each command in your `forge.yaml`, create a Markdown file:

   ```bash
   # Example: converting a commit command
   touch ~/forge/commands/commit.md
   ```

3. Add the frontmatter with `name` and `description` fields

4. Add the prompt as the body content (without `prompt:` prefix)

5. Remove the `commands` section from your `forge.yaml`

6. Restart Forge to load the new command definitions

### Example Migration

**Before (forge.yaml):**

```yaml
commands:
  - name: check
    description: Checks if the code is ready
    prompt: |
      Run linting and tests
```

**After (~/forge/commands/check.md):**

```markdown
---
name: check
description: Checks if the code is ready
---

Run linting and tests
```

## Related Documentation

- [Custom Workflows](../custom-workflows) - Learn how to create sophisticated workflows with multiple agents
- [Agent Configuration](../agent-configuration) - Configure agents to respond to custom commands
- [Commands](../commands) - Learn about Forge's built-in commands
````
