---
title: ZSH Support
sidebar_position: 6
description: "Enhanced terminal integration with ZSH prompt support, fuzzy file finding, and syntax highlighting."
sidebar_label: ZSH Support
---

import Steps, {Step} from "../components/Steps"

# ZSH Support

Forge's ZSH integration brings AI assistance directly to your terminal using the `:` sentinel character, letting you stay in your native shell environment with all your aliases, functions, and custom tooling intact. No more switching to interactive mode and losing access to years of shell customization.

:::tip Why the `:` Sentinel Character Matters
**The Problem**: Forge's interactive mode creates a separate environment where your ZSH aliases, custom functions, and carefully crafted shell setup don't work.

**The Solution**: Use `:` to send prompts to Forge while staying in your native ZSH session:

```bash
# Your zsh plugins work normally
gst

# But you can also get AI help instantly
: analyze the memory usage patterns in @src/server.rs

# Run your custom tools as part of your investigation
ps aux | grep server
htop -p $(pgrep server)

# Continue with full context about the analysis
: now optimize the memory allocations you identified in the server struct
```

**The Result**: Keep your shell environment while getting AI assistance, maintaining context across both AI tasks and your custom shell operations.
:::

## Capabilities

- **Native Shell Integration**: Use the `:` sentinel character to access Forge AI while preserving all your ZSH aliases, functions, PATH modifications, and custom tooling - no separate environment
- **Intelligent Context Management**: Maintain conversation context across AI prompts and shell commands, with `:reset` control and agent targeting via `:agent`
- **Enhanced File Operations**: Fuzzy file finding with `@filename<Tab>` using fd/fzf, plus syntax highlighting optimized for dark terminals

## Installation

<Steps>
  <Step title="Install Forge">
    First, [install and set up Forge](/docs/installation) following the main installation guide.
    
    You can use either installation method (npx or global), but note which one you choose as you'll need to set `$FORGEBIN` accordingly in Step 2.
  </Step>

  <Step title="Configure ZSH Integration">
    Add the Forge ZSH prompt integration to your shell configuration:

    **For Global Installation:**
    Add these lines to your `~/.zshrc`:
    ```bash
    # Set FORGEBIN for global installation
    export FORGEBIN=forge

    # Enable Forge ZSH integration
    source <($FORGEBIN generate-zsh-prompt)
    ```

    **For npx Usage:**
    Add these lines to your `~/.zshrc`:
    ```bash
    # Set FORGEBIN for npx usage
    export FORGEBIN="npx forgecode"

    # Enable Forge ZSH integration
    source <($FORGEBIN generate-zsh-prompt)
    ```

    After editing `~/.zshrc`, reload your shell:
    ```bash
    source ~/.zshrc
    ```

  </Step>

  <Step title="Install File Finding Dependencies">
    ZSH Support requires `fd` and `fzf` for file tagging functionality. **Without these dependencies, the `@filename<Tab>` fuzzy file finding will not work.**

    See our [fd and fzf Installation Guide](/docs/fd-fzf-installation) for platform-specific installation instructions.

  </Step>

  <Step title="Verify Installation">
    Test that the integration is working:
    ```bash
    # This should show syntax highlighting and be ready for input
    : hello world
    ```

    You should see syntax highlighting and the command should execute successfully.

  </Step>
</Steps>

## Quick Start

After installation, test ZSH Support with these commands:

```bash
# Basic prompt - should show syntax highlighting
: hello, can you help me debug this shell script?

# Agent-specific prompt (if you have sage configured)
:sage what's the difference between ps aux and ps -ef?

# Conversation reset
:reset

# File tagging (requires fd/fzf)
: explain the config in @package.json<Tab>
```

If you see syntax highlighting and the commands execute, you're ready to go!

## Usage

### Basic Prompt Execution

Send prompts directly to Forge using the `:` prefix:

```bash
: explain this error message
: refactor this function to be more readable
: add error handling to the database connection
```

The prompt will be sent to your last used agent, defaulting to the main Forge agent if no previous agent was used.

### Agent-Specific Prompts

Target specific agents by including the agent name after the colon:

```bash
:sage explain the algorithm complexity
:reviewer check this code for security issues
:architect design a microservices structure
```

:::info Agent Names
These are example agent names. Use `/agents` in your Forge session to see your configured agents, or check your agent configuration files to see which agents you have available.
:::

This sends the prompt directly to the specified agent, making it easy to use specialized agents for different tasks.

### File Tagging with Fuzzy Finding

Tag files in your prompts using `@` followed by the filename and pressing Tab:

```bash
: review the changes in @package.json<Tab>
: explain the logic in @src/utils/helper<Tab>
: optimize the performance of @database/queries<Tab>
```

When you press Tab after typing `@` and partial filename:

- A fuzzy finder window opens using `fzf`
- Type to filter files by name
- Use arrow keys to navigate
- Press Enter to select the file
- The full file path will be inserted into your prompt

:::info Fuzzy File Search
The fuzzy finder searches through your project files using `fd`, providing fast and intuitive file selection. It respects your `.gitignore` and other ignore files automatically.
:::

## Session Continuity

ZSH Support maintains intelligent conversation context across commands while giving you control over when to preserve or reset that context:

### Context Preservation

The agent remembers previous conversations within the same terminal session:

```bash
# Start analyzing a performance issue
: the database queries are running slow, can you help me investigate?

# Run some shell commands for investigation
ps aux | grep postgres
htop -p $(pgrep postgres)

# Continue the conversation - agent remembers the database context
: based on what I found, the CPU usage is high, what should I check next?
```

### Context Reset

Use `:reset` when switching to completely different tasks to avoid context interference:

```bash
# Working on database optimization
: analyze the slow queries in @database/analytics.sql

# Switch focus to a completely different task
:reset

# Now start fresh on a new topic - no database context carried over
: help me set up CI/CD pipeline for this project
```

The `:reset` command clears the conversation history, ensuring previous context doesn't influence new tasks. This gives you the best of both worlds: context when you need it, clean slate when you don't.

## Troubleshooting

### Command Not Found

If `: command not found` appears:

1. Ensure you've added the source line to `~/.zshrc`
2. Reload your shell: `source ~/.zshrc`
3. Verify `FORGEBIN` is set correctly: `echo $FORGEBIN`

### Fuzzy Finder Issues

If file tagging doesn't work (`@filename<Tab>` does nothing):

1. Verify `fd` is installed: `fd --version`
2. Verify `fzf` is installed: `fzf --version`
3. Check that both are in your PATH: `which fd fzf`

:::warning File Tagging Requirements
File tagging with `@filename<Tab>` requires both `fd` and `fzf`. Without these tools, pressing Tab after `@` will not trigger the fuzzy finder, and you'll need to type full file paths manually. See our [fd and fzf Installation Guide](/docs/fd-fzf-installation) for installation instructions.
:::

### Syntax Highlighting Problems

If highlighting doesn't appear:

1. Ensure you're using ZSH (not bash): `echo $SHELL`
2. Check that your terminal supports colors: `echo $TERM`
3. Try resetting highlighting: `source ~/.zshrc`

### Agent Not Found

If you get "agent not found" errors:

1. Check your available agents: `/agents` (run this in a Forge session)
2. Verify agent name spelling (case-sensitive)
3. Test with a diagnostic command: `: list my current working directory and git status`

## Performance Tips

- **File caching**: The fuzzy finder caches file listings for better performance
- **Agent persistence**: Once an agent is used, it stays active for faster subsequent calls
- **Incremental search**: Type a few characters in the fuzzy finder to quickly narrow results
- **History integration**: Previous prompts are saved to ZSH history for easy recall

:::tip Pro Tip
Use ZSH integration with the `:` sentinel for quick requests and shell-heavy workflows where you need your aliases and custom tooling. Keep the interactive mode for longer coding sessions that don't require your shell customizations. This gives you the best of both worlds - your native shell environment for system work and full Forge features for development.
:::
